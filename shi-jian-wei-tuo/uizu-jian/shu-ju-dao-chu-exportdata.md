# 数据导出 ExportData

作用：将数据库的数据，通过存储过程查询后导出到Excel文件；

### 设计属性

* ##### 活动标题

  * 类型：字符串；

  * 值：默认值：数据导出；

  * 说明：
* ##### 活动注释

  * 类型：字符串；

  * 值：

  * 说明：对活动的说明；
* ##### 数据标题

  * 类型：字符串；

  * 默认值：默认：数据导出；

  * 说明：导出数据时的页面显示标题；
* ##### 服务地址

  * 类型：字符串；

  * 说明：数据库所在服务器地址，不能为空和undefined；
* ##### 服务资源

  * 类型：字符串；

  * 示例：DB.FX.Storage.MongoDBService；

  * 说明：服务器配置的服务资源名；
* ##### 存储服务

  * 类型：字符串；

  * 示例：DBAzure；

  * 说明：服务器配置的存储服务名；
* ##### 数据库

  * 类型：字符串；

  * 示例：DB\_Test；

  * 说明：操作的数据库名；
* ##### 存储过程

  * 类型：字符串；

  * 示例：SP………；

  * 说明：存储数据调用的存储过程名；

  * 注：调用sql存储过程查询数据时，书写格式：存储过程名 @QParams,@CPIdx,@SkipRow，存储过程名后面有一个空格，三个参数名称和顺序为固定写法，QParams-自定义传入的JSON格式参数对象，CPIdx-当前导出页，数值类型，从1开始，SkipRow-忽略数据行数，数值类型，从0开始；示例：sql\_ExportData @QParams,@CPIdx,@SkipRow；编写sql存储过程时要接收这三个同名参数；
* ##### 参数对象

  * 类型：对象；

  * 示例：@{}；

  * 说明：查询数据需要的参数对象，会以JSON字符串的格式传入到存储过程的第一个参数；；
* ##### Excel表名

  * 类型：字符串；

  * 示例：导出数据.csv；

  * 说明：生成的Excel表格的文件名\(带有文件类型后缀\)；
* ##### 表头集合

  * 类型：字符串；

  * 示例：colum1, colum2,colum3,colum4,colum5；

  * 说明：生成表格的第一行列名，各列名之间用逗号（英文输入法下的逗号）分隔；
* ##### 列名集合

  * 类型：数组；

  * 示例：@\["Column1"," Column2"," Column3"," Column4"," Column5"\]；

  * 说明：每列数据在所对应的列名，按照顺序填写，填写的顺序就是导出到表格后列的顺序；

#### _存储过程编写要求_

##### 存储过程接收参数：

1、QParams-JSON格式字符串，查询需要的参数对象；

2、cp-数值，当前查询的页数，从1开始；

3、skipC-数值，已导出的数据行数；

##### 存储过程需要返回对象：![](/assets/ExportData1.png)

```js
示例：{Pager:{PageCount:5,RowCount:1000},Items:[{},{}]}
```



