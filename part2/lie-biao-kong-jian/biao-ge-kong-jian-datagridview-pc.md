# 表格控件 DataGridView（PC）

---

### 设计属性

* ##### 对象名称

  * 类型：字符串；

  * 值：

  * 说明：自定义控件对象名；
* ##### 允许显示行号

  * 类型：（单选框）；

  * 值：默认选中

  * 说明：是否显示行号；
* ##### 支持单元格编辑

  * 类型：（单选框）；

  * 值：

  * 说明：是否支持单元格编辑；
* ##### 显示分组面板

  * 类型：（单选框）；

  * 说明：是否显示分组面板；
* ##### 自动展开分组

  * 类型：（单选框）；

  * 说明：默认选中，是否自动展开分组；
* ##### 添加列

  * 类型：（按钮）；

  * 说明：添加一列；
* ##### 清除列

  * 类型：（按钮）；

  * 说明：清除选中的列；
* ##### 调整列顺序

  * 类型：（按钮）；

  * 说明：
* ##### 生成预览数据

  * 类型：（按钮）；

  * 说明：生成预览数据，查看设计效果；
* ##### 默认选中行

  * 类型：数值；

  * 值：默认：无

  * 说明：数值从0开始。设置之后，会在表格加载完成，选中设置行，触发RowClick事件；

##### 注:每行Row就是一个表单Form；行对象的属性DataGridView，指向当前表格控件本身。

#### 编辑对象分类-设计属性

* ##### 列标题

  * 类型：字符串；

  * 值：

  * 说明：设置列头显示的标题；
* ##### 列属性

  * 类型：字符串；

  * 值：

  * 说明：设置列的赋值属性，符合变量命名规则。不能为空。禁止设置为Add；
* ##### 格式化

  * 类型：字符串；

  * 值：

  * 说明：日期控件可以设置日期格式化，如：yyyy-MM-dd；
* ##### 列宽度

  * 类型：字符串；

  * 值：默认值：128px；

  * 说明：设置列宽度，不能为百分比；
* ##### 对齐方式

  * 类型：（下拉选框）；

  * 说明：可选值：左对齐、右对齐、居中；
* ##### 编辑控件类型

  * 类型：（下拉选框）；

  * 值：默认值：文本控件

  * 说明：可选值：文本控件、单选控件、日期控件；
* ##### 编辑提示

  * 类型：字符串；

  * 说明：
* ##### 编辑验证

  * 类型：字符串；

  * 说明：
* ##### 错误提示

  * 类型：字符串；

  * 说明：
* ##### 允许单元格编辑

  * 类型：（单选框）；

  * 值：

  * 说明：
* ##### 支持排序

  * 类型：（单选框）；

  * 说明：默认选中；
* ##### 支持自定义分组

  * 类型：（单选框）；

  * 说明：
* ##### 预设为分组列

  * 类型：（单选框）；

  * 说明：是否预设为分组列；
* ##### 背景颜色

  * 类型：（颜色选择器）；

  * 说明：
* ##### 文字颜色

  * 类型：（颜色选择器）；

  * 说明：

### 事件处理程序

* ##### SelectedRowChanged

  * 调用时机：选中行改变时；
  * 说明：事件触发者为行对象；
* ##### SelectedCellChanged

  * 调用时机：选中单元格发生改变时；
  * 说明：事件触发者为单元格对象；
* ##### CellClick

  * 调用时机：点击单元格时；
  * 说明：事件触发者为单元格Cell对象；
* ##### RowClick

  * 调用时机：单击行时；
  * 说明：事件触发者为行对象
* ##### RowDblClick

  * 调用时机：双击某行时；
  * 说明：事件触发者为行对象；

### 属性、方法

* ##### ItemSource-属性，获取/设置数据源；

  * 说明：数组，默认值为undefined；
* * 示例：
  * ```js
    DataGridView.ItemSource = [{'Name':'Jack','age':12,……},……]    ;//DataGridView为控件对象
    ```
* ##### SelectedRow-属性，获取点击行；

  * 说明：对象；
* * 示例：
  * ```js
    var selectedRow = DataGridView.SelectedRow;//DataGridView为控件对象
    ```
* ##### Rows-属性，获取所有创建行对象集合；

  * 说明：数组，存储着绘制完成的每一个行对象；由于表格的创建是延时操作，延时50ms,所以给表格的数据源ItemSource赋值后，不能立即获取到Rows；有分组的情况下，分组行也在此集合里，可通过行对象属性CloneDataContext值是否为undefined判断是否为分组行；
* * 示例：
  * ```js
    var rows = DataGridView.Rows;   //DataGridView为控件对象
    ```
* ##### OnRowClick\(row\)-方法，点击某行；

  * 说明：参数row为行对象；
* * 示例：
  * ```js
    DataGridView. OnRowClick(row);//DataGridView为控件对象
    ```
* ##### Column-单元格对象Cell的属性Column；

  * 说明：Column对象的属性：
    1、Index-列索引，数值类型。当前单元格所在列索引，从0开始；2、Property-单元格绑定的属性名；3、Text-单元格显示的文字；4、ColType-列类型，字符串，“1”-单选列；
* * 示例：
  * ```js
    var column = Cell.Column;//Cell为单元格控件对象
    ```
* ##### CloneDataContext\(\)-方法，获取有分组表格的点击行数据；

  * 说明：返回值为点击行的数据上下文对象；
  * 注意：分组行没有CloneDataContext方法；
* * 示例：
  * ```js
    var data = DataGridView.SelectedRow.CloneDataContext();//DataGridView为控件对象
    ```
* ##### RemoveRow\(row\)-方法，移除行；

  * 说明：参数row为需要移出的行对象；
* * 示例：
  * ```js
    DataGridView.RemoveRow(row);    ;   //DataGridView为控件对象
    ```
* ##### BkC\_VaLue-通过数据设置表格行背景颜色；

  * 说明：返回数据含BkC\_VaLue列，值为颜色值，例: item.BkC\_VaLue="red"；
* ##### Fc\_VaLue-通过数据设置表格行字体颜色；

  * 说明：返回数据含Fc\_VaLue列，值为颜色值，例:item. Fc\_VaLue="red"；
* ##### DataGridView-行对象属性，通过行对象获取所在表格控件对象；

  * 说明：对象；
* * 示例：
  * ```js
    var dataGridView = Row.DataGridView;    //Row为表格控件的某一个行对象;
    ```



